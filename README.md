# Dynamical System Analysis

このリポジトリは、ハミルトン系の動的システムを解析するためのツールを提供します。主に、トーラスからカオスへの遷移を検出し、シミュレーション結果を解析することと、3自由度ハミルトン系におけるNHIM（正規双曲不変多様体）上の初期条件と再交差時間の関係を解析することを目的としています。

## モデルの説明

### ハミルトニアン

この研究で扱う3自由度双穴ポテンシャル系のハミルトニアンは以下のとおりです：
$$H(x, y, z, px, py, pz) = (px² + py² + pz²)/2 + (x² - 1)² + (ωy²y² + ωz²z²)/2 + γx²(y² + z²)$$

ここで：
- 第1項は運動エネルギー
- 第2項と第3項（`-a·x² + b·x⁴`）によってx方向に双穴ポテンシャルを形成
- 第4項（`c·(y² + z²)`）はy,z方向に調和振動子的な閉じ込めを与える
- パラメータa, b, cはポテンシャルの形状を決定する定数

このシステムは、x = 0近傍に鞍点を持ち、その周りにNHIM（正規双曲不変多様体）が形成されます。

### NHIM上の変数

NHIM上の初期条件は以下の変数によって特徴付けられます：

- **φy, φz**: y, z方向の位相角（0から2πの範囲）
  - 解析では通常、2πで割って0-1の範囲に正規化
  - 初期状態でのNHIM上の位置を指定
  - プログラム内では`phi_y`、`phi_z`として表現

- **Iy, Iz**: y, z方向の作用変数
  - 振動の振幅（エネルギー）に関連
  - 全エネルギーEとの関係：`E = Ey + Ez + Es`
    - `Es`: 鞍点エネルギー
    - `Ey, Ez`: y, z方向の振動エネルギー

- **再交差時間**: トラジェクトリがNHIMを出発してから再びNHIMを横切るまでの時間
  - カオス的挙動の指標として使用
  - プログラム内では`recross_times`として保存

## 主な機能

- **シンプレクティック積分法**: ハミルトン系の運動方程式を数値的に解くための手法を提供します。
- **ウェーブレット変換解析**: シミュレーション結果をウェーブレット変換を用いて解析し、周波数成分を可視化します。
- **トーラスからカオスへの遷移検出**: ポアンカレ断面図を用いて、トーラスからカオスへの遷移を検出します。
- **NHIM分析**: 3次元双穴ポテンシャル系におけるNHIM上の初期条件と再交差時間の関係を解析します。
- **生存確率計算**: トラジェクトリの再交差時間から生存確率曲線を導出し、冪則・指数分布と比較します。
- **クラスタリング解析**: t-SNEやK-Meansを用いた高度なデータ分析機能を提供します。

## スクリプトの説明

### 基本解析ツール
- `orbit_analysis.py`: トーラスからカオスへの遷移を起こす初期条件を抽出し、その結果を`best_transitions.txt`に保存します。
- `hamilton2d.py`: `best_transitions.txt`から遷移軌道のパラメータを読み込み、シミュレーションを実行し、結果をPDFとして保存します。
- `hamilton1.py`: 2つの振動子の運動をシミュレーションし、ウェーブレット変換を用いて解析します。

### 3自由度ハミルトン系解析スイート
- **`double_well_3d.py`**: 3次元双穴ポテンシャル系のメインシミュレーション。NHIMからの初期条件でトラジェクトリを計算し、再交差時間を測定します。
  - シンプレクティック積分法を使用
  - 並列計算による高速シミュレーション
  - 位相空間上での初期条件分布の可視化
  - クラスタリングによる構造抽出

- **`01_run_simulation.py`**: 複数のエネルギー値と減衰係数でシミュレーションを実行し、結果を保存します。

- **`02_analyze_survival.py`**: シミュレーション結果から生存確率を計算・プロット。
  - 再交差時間からの生存確率曲線の導出
  - 冪則・指数分布のフィッティング
  - パラメータ依存性の可視化

- **`03_analyze_nhim_distribution.py`**: NHIM上の初期条件の分布と再交差時間の関係を詳細に解析。
  - 位相分布の可視化
  - 特定領域に焦点を当てた拡大分析
  - log10時間刻みでのタイムスライス可視化（1.0刻み）
  - t-SNEやK-Meansによる高度なデータ分析

## 使用方法

### 基本解析ツール
1. 必要なPythonパッケージをインストールします。
   ```bash
   pip install numpy matplotlib scipy pywt
   ```

2. 各スクリプトを実行して、シミュレーションと解析を行います。
   - `orbit_analysis.py`を実行して、トーラスからカオスへの遷移を起こす初期条件を抽出し、結果を`best_transitions.txt`に保存します。
   - `hamilton2d.py`を実行して、`best_transitions.txt`から読み込んだパラメータで詳細な解析を行い、結果をPDFに保存します。
   - `hamilton1.py`を実行して、基本的なシミュレーションと解析を行います。

## 結果の保存

- シミュレーション結果は、`orbit_analysis_results`ディレクトリにPDF形式で保存されます。
- 遷移軌道の詳細な結果は、`transition_results.pkl`に保存されます。

このリポジトリは、動的システムの解析に興味のある研究者やエンジニアにとって有用なツールを提供します。
