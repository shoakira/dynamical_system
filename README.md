# Dynamical System Analysis

このリポジトリは、ハミルトン系の動的システムを解析するためのツールを提供します。主に、トーラスからカオスへの遷移を検出し、シミュレーション結果を解析することと、3自由度ハミルトン系におけるNHIM（正規双曲不変多様体）上の初期条件と再交差時間の関係を解析することを目的としています。

## 主な機能

- **シンプレクティック積分法**: ハミルトン系の運動方程式を数値的に解くための手法を提供します。
- **ウェーブレット変換解析**: シミュレーション結果をウェーブレット変換を用いて解析し、周波数成分を可視化します。
- **トーラスからカオスへの遷移検出**: ポアンカレ断面図を用いて、トーラスからカオスへの遷移を検出します。
- **NHIM分析**: 3次元双穴ポテンシャル系におけるNHIM上の初期条件と再交差時間の関係を解析します。
- **生存確率計算**: トラジェクトリの再交差時間から生存確率曲線を導出し、冪則・指数分布と比較します。
- **クラスタリング解析**: t-SNEやK-Meansを用いた高度なデータ分析機能を提供します。

## スクリプトの説明

### 基本解析ツール
- `orbit_analysis.py`: トーラスからカオスへの遷移を起こす初期条件を抽出し、その結果を`best_transitions.txt`に保存します。
- `hamilton2d.py`: `best_transitions.txt`から遷移軌道のパラメータを読み込み、シミュレーションを実行し、結果をPDFとして保存します。
- `hamilton1.py`: 2つの振動子の運動をシミュレーションし、ウェーブレット変換を用いて解析します。

### 3自由度ハミルトン系解析スイート
- **`double_well_3d.py`**: 3次元双穴ポテンシャル系のメインシミュレーション。NHIMからの初期条件でトラジェクトリを計算し、再交差時間を測定します。
  - シンプレクティック積分法を使用
  - 並列計算による高速シミュレーション
  - 位相空間上での初期条件分布の可視化
  - クラスタリングによる構造抽出

- **`01_run_simulation.py`**: 複数のエネルギー値と減衰係数でシミュレーションを実行し、結果を保存します。

- **`02_analyze_survival.py`**: シミュレーション結果から生存確率を計算・プロット。
  - 再交差時間からの生存確率曲線の導出
  - 冪則・指数分布のフィッティング
  - パラメータ依存性の可視化

- **`03_analyze_nhim_distribution.py`**: NHIM上の初期条件の分布と再交差時間の関係を詳細に解析。
  - 位相分布の可視化
  - 特定領域に焦点を当てた拡大分析
  - log10時間刻みでのタイムスライス可視化（1.0刻み）
  - t-SNEやK-Meansによる高度なデータ分析

## 使用方法

### 基本解析ツール
1. 必要なPythonパッケージをインストールします。
   ```bash
   pip install numpy matplotlib scipy pywt
   ```

2. 各スクリプトを実行して、シミュレーションと解析を行います。
   - `orbit_analysis.py`を実行して、トーラスからカオスへの遷移を起こす初期条件を抽出し、結果を`best_transitions.txt`に保存します。
   - `hamilton2d.py`を実行して、`best_transitions.txt`から読み込んだパラメータで詳細な解析を行い、結果をPDFに保存します。
   - `hamilton1.py`を実行して、基本的なシミュレーションと解析を行います。

## 結果の保存

- シミュレーション結果は、`orbit_analysis_results`ディレクトリにPDF形式で保存されます。
- 遷移軌道の詳細な結果は、`transition_results.pkl`に保存されます。

このリポジトリは、動的システムの解析に興味のある研究者やエンジニアにとって有用なツールを提供します。
